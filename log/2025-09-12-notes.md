# 2025-09-12 作業ログ（要約）

- アーキテクチャ: Rustコア + Tauri（GUI）で初期スケルトンを作成
- コア
  - `image` クレートの EXR デコーダを採用（`features=["png","exr"]`）。
  - プレビュー生成（露出、ガンマ、LUT(.cube 1D/3D)）と PNG 書き出しを実装。
- CLI
  - `preview`（PNG出力）、`probe`（座標のリニアRGBA取得）を実装。
- GUI
  - Tauri v1 最小実装。プレビュー表示、座標プローブ、PNG書き出し。
  - アイコン欠如でビルドが落ちる問題 → build.rs でプレースホルダーICOを自動生成し解決。
  - ログパネルを追加（UI上に表示／Rust側はファイル追記）。
  - Tauri API 取得のリトライ実装（`window.__TAURI__` 未注入のケースに対応）。
  - tauri.conf.json を調整（`withGlobalTauri: true`、`allowlist.dialog` を有効）。
- 既知の課題
  - 一部環境で `__TAURI__` グローバルが取得できないケースがあり、現在は5秒リトライで検出。必要に応じ `tauri://ready` 監視を追加予定。
  - ファイルログは Rust 側コマンドが実行される時に生成される（現状は未生成＝invoke未到達の兆候）。
- 次の候補タスク
  - `tauri::async_runtime::spawn` 等で重い処理を非同期化。
  - プレビュー高品質リサイズ、OCIO連携、メタデータ編集機能の実装。

## 実行・デバッグ手順メモ
- GUI: `cd apps/exrtool-gui/src-tauri && cargo tauri dev`
- CLI: `cargo run -p exrtool-cli -- preview <in.exr> -o out.png`
- ログファイル: `apps/exrtool-gui/src-tauri/exrtool-gui.log`（ウィンドウを閉じても残る）

